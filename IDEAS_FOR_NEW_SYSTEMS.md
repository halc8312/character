# 新システム提案書

このドキュメントでは、キャラクターデータベースリポジトリに実装可能な面白いシステムの候補をまとめています。

---

## 1. 🎭 シーンジェネレーター（Scene Generator）

### 概要
複数のキャラクターを選択し、自動的にシーン（会話・対立・協力など）を生成するシステム。

### 特徴
- キャラクター同士の関係性（`relationships`）と性格（`personality`）を考慮
- 関係の強度（`intensity`）に基づいて適切な会話トーンを調整
- `ai_portrayal.example_dialogue` を活用した自然な会話生成

### 実装イメージ
```yaml
scene_templates/
├── encounter.yml        # 初対面のシーン
├── conflict.yml         # 対立シーン
├── collaboration.yml    # 協力シーン
└── reunion.yml          # 再会シーン
```

### なぜ面白いか
相関図は静的な関係を見せるが、シーンジェネレーターは動的なストーリーの可能性を提示できる。

---

## 2. 📊 キャラクター比較ビューア（Character Comparison View）

### 概要
2〜4人のキャラクターを横並びで比較し、類似点・相違点を可視化するシステム。

### 特徴
- 性格特性（traits）のレーダーチャート表示
- 共通タグと異なるタグの視覚化
- 関係性の重複分析（共通の友人/敵など）
- 目標（goals）や動機（motivations）の対比表示

### 実装イメージ
```
site/
├── compare.html         # 比較ページ
└── assets/
    └── compare.js       # 比較ロジック
```

### URL例
`/compare.html?ids=haruto_tanaka,yuna_kirishima,ren_kobayashi`

### なぜ面白いか
対立するキャラクターの違いや、仲間同士の意外な共通点を発見できる。

---

## 3. ⏳ タイムライン機能（Timeline Feature）

### 概要
キャラクターの人生の重要イベント（`background.key_events`）を時系列で表示するシステム。

### 特徴
- 各キャラクターのライフイベントを年代順に配置
- 複数キャラクターのイベントを同一タイムラインに重ねて表示
- イベント同士の因果関係や同時期の出来事を可視化
- ストーリーの「key_scenes」との連携

### 拡張案
```yaml
# キャラクターファイルの拡張
background:
  key_events:
    - date: "2020-04"           # YYYY-MM 形式（年と月のみ）
      event: "高校入学"
      related_characters: [yuna_kirishima]
```

> **注**: 実装時には日付形式（ISO 8601推奨）やフィールドの必須/任意の定義が必要です。

### なぜ面白いか
物語の時系列を整理し、過去のイベントがどう現在に影響しているかを理解できる。

---

## 4. 🎲 ランダムイベントジェネレーター（Random Event Generator）

### 概要
キャラクターの設定に基づいて、予想外のイベントやシチュエーションを提案するシステム。

### 特徴
- キャラクターの`fears`、`conflicts`、`secrets`を活用
- 関係性の`intensity`が低い相手との遭遇イベント
- `abilities.limitations`を試すシチュエーション生成

### イベント例
```
# テンプレート構文例: {{character.field}} 形式
「{{haruto_tanaka.name}}の秘密「{{haruto_tanaka.secrets[0]}}」が{{ren_kobayashi.name}}に発覚！」
「{{miki_sawada.name}}が{{haruto_tanaka.name}}の「{{haruto_tanaka.weaknesses[0]}}」という弱点を指摘するシーン」
```

### なぜ面白いか
物語のスパイスとなる展開を自動提案し、創作のインスピレーションになる。

---

## 5. 🗺️ ロケーションマップ（Location Map）

### 概要
キャラクターの活動場所や出身地を地図上にプロットするシステム。

### 特徴
- `background.birthplace`、`profile.affiliation` から位置情報を抽出
- 同じ場所に所属するキャラクターをグループ化
- 場所ごとのキャラクター一覧表示
- 勢力図（faction）の地理的可視化

### 新規ファイル案
```yaml
locations/
├── _TEMPLATE.location.yml
├── nishigaoka_high_school.yml
└── north_kanto_city.yml

# location ファイルのスキーマ案
id: nishigaoka_high_school
name: "県立西ヶ丘高校"
type: school                    # school, city, region など
coordinates:                    # 任意: 地図表示用
  lat: 36.3xxx
  lng: 139.0xxx
description: "物語の主要舞台となる公立高校"
affiliated_characters:
  - haruto_tanaka
  - yuna_kirishima
```

### なぜ面白いか
相関図が「人間関係」なら、ロケーションマップは「空間関係」を可視化できる。

---

## 6. 💬 キャラクターチャットシミュレーター（Character Chat Simulator）

### 概要
選択したキャラクターと1対1で会話できるチャットインターフェース。

### 特徴
- `ai_portrayal`のガイドラインを元にキャラクターの返答スタイルを表示
- `behavior.speech_style`、`catchphrases`を活用
- 感情状態（`emotional_responses`）に基づく反応パターン提示
- 会話履歴をエクスポート可能

### 実装イメージ
```
site/
├── chat.html            # チャットUI
└── assets/
    └── chat.js          # チャットロジック
```

### なぜ面白いか
AIとの連携で、本当にそのキャラクターと会話しているような体験ができる。

---

## 7. 📈 関係性変遷グラフ（Relationship Evolution Graph）

### 概要
キャラクター間の関係性の変化を時系列で追跡するシステム。

### 特徴
- 関係の始まり、変化のきっかけ、現在の状態を記録
- intensity の変遷を折れ線グラフで可視化
- 関係タイプの変化（friend → enemy、crush → lover など）をトラッキング

### スキーマ拡張案
```yaml
relationships:
  - target_id: yuna_kirishima
    type: friend
    intensity: 4
    history:                      # 任意: 関係の変遷を記録
      - date: "2015"              # YYYY または YYYY-MM 形式
        type: acquaintance        # vocab.yml の relationship_types から
        intensity: 2              # -5〜5 の範囲
        note: "隣に引っ越してきた"
      - date: "2018"
        type: friend
        intensity: 4
        note: "中学で同じクラスになった"
```

> **注**: `history` は任意フィールド。各エントリには `date`、`type`、`intensity` が必須で、`note` は任意。

### なぜ面白いか
相関図の「静的なスナップショット」に対して、関係性の「動的な物語」を表現できる。

---

## 8. 🔗 勢力図ビューア（Faction Network View）

### 概要
`faction/`タグや`profile.affiliation`に基づき、組織・グループ間の関係を可視化するシステム。

### 特徴
- 同じ組織に属するキャラクターをクラスタリング
- 組織間の関係（同盟・対立・中立）を表示
- 組織内の階層構造（superior/subordinate）を表示
- 組織のメンバー数や影響力を視覚化

### 実装イメージ
```
site/
├── factions.html        # 勢力図ページ
└── assets/
    └── factions.js      # 勢力図ロジック
```

### なぜ面白いか
個人レベルの相関図から、より大きな「勢力構造」を俯瞰できる。

---

## 9. 🎯 キャラクター診断テスト（Character Quiz）

### 概要
ユーザーが質問に答えることで、どのキャラクターに似ているかを診断するシステム。

### 特徴
- `personality.traits`、`values`、`fears`を元に質問を生成
- 回答に基づいて最も類似するキャラクターをマッチング
- 結果をSNSでシェア可能
- 「〇〇度」のようなパーセンテージ表示

### 実装イメージ
```
site/
├── quiz.html            # 診断ページ
└── assets/
    └── quiz.js          # 診断ロジック
```

### なぜ面白いか
インタラクティブな体験を通じて、キャラクターへの愛着が深まる。ファンコミュニティで拡散されやすい。

---

## 10. 📖 キャラクター辞典自動生成（Character Encyclopedia Generator）

### 概要
キャラクターデータから読み物形式のプロフィールを自動生成するシステム。

### 特徴
- YAMLの構造化データから自然な文章に変換
- テンプレートを選択可能（公式プロフィール風、インタビュー風、小説風など）
- PDF/画像としてエクスポート可能
- 多言語対応のベース

### 出力例
```
【田中 陽斗（17歳）】

どこにでもいるような男子高校生で、清潔感はあるが目立たない。
温厚で優しく、空気を読むタイプ。自分から前に出ることは少ないが、
困っている人を見ると放っておけない性格の持ち主。

県立西ヶ丘高校に通う彼の目標は、平和に高校生活を送り、
無事に卒業すること。しかし心の奥では、一度くらい誰かに
堂々と褒められる経験がしてみたいと思っている...
```

### なぜ面白いか
データベースとしてのキャラクター情報を、読み手に伝わりやすい形に変換できる。

---

## 優先度の提案

| 優先度 | システム | 理由 |
|--------|----------|------|
| ⭐⭐⭐ | キャラクター比較ビューア | 既存の相関図と補完関係にあり、実装コストが低い |
| ⭐⭐⭐ | 勢力図ビューア | Cytoscape.jsを再利用でき、新しい視点を提供 |
| ⭐⭐ | タイムライン機能 | スキーマ拡張が必要だが、ストーリー理解に有用 |
| ⭐⭐ | キャラクター診断テスト | エンターテイメント性が高く、ユーザー参加型 |
| ⭐ | シーンジェネレーター | AI連携が前提となり、実装が複雑 |
| ⭐ | チャットシミュレーター | AI API必須で、外部依存が大きい |

---

## まとめ

現在の相関図システムは「キャラクター間の関係」を可視化していますが、上記の提案システムは以下の視点を追加します：

- **時間軸**（タイムライン、関係性変遷）
- **空間軸**（ロケーションマップ）
- **組織構造**（勢力図）
- **インタラクティブ性**（診断、チャット、シーン生成）
- **比較分析**（比較ビューア）

これらを組み合わせることで、キャラクターデータベースをより立体的で魅力的なシステムに発展させることができます。
